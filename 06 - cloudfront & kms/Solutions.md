Challenges: 

## Challenge 01 Solutions: 
01) Navigate to the KMS Console. View the "Customer Managed Keys". These are the keys that users have created and maintain. Click on the "AWS Managed Keys". These are the keys that AWS Manages. You may or may not see keys in here, based on what AWS services you have running that require encryption. 
02) Create a CMK. Go back to "Customer Managed Keys" and then click the orange "Create key" button. For this exercise, you will choose a Symmetric key. You will also choose "Encrypt and decrypt" for Key usage. Click on the Advanced options. These are options that allow you to further customize a key. You can choose the Key material origin, e.g., how the key gets created. For this exercise, we'll leave it as KMS. But if you have a key already created that you want to import, this is where you'd configure that. The next option is the Regionality. By default, keys are limited to the region that they are created in. However, you can create a Multi-region key if needed. Let's leave this as default and just click Next. 
03) You'll need to give the key an alias. An alias allows you to rotate the key material, without having the update any applications. Give the key an alias of `week-06-s3-key`. 
04) Next you'll need to provide a Key administrator. These are users that are allowed to delete and update the key, but not necessarily use the key. By default, the user or role who creates the key will be granted access to the key.  Click Next. 
05) Now you'll need to define who can use the key. Choose your user or role for this step. 
06) Review the key policy and then click "Finish" 
07) Let's update one of the buckets to use this key. Navigate to S3 and select the bucket that starts with `week-06-bucket..`. Navigate to the Properties section and scroll down to Default encryption. By default, it uses the AWS Managed key (SSE-S3). We didn't see this on the list of keys earlier because it wasn't actively being used. Once we upload an object to the bucket we will see it listed. However, for this step, we're going to change the default encryption, so select Edit. For the encryption key type, select the AWS Key Management Service key (SSE-KMS). Then select the option that says "Choose from your own AWS KMS keys". Find the key we just created, then hit "Save changes". You'll land back on the Properties page and note that the default encryption is now using the KMS key we just created. Let's test this by uploading an object. 
08) Upload the `index02.html` file into the S3 bucket. (Note: Click on 'Raw' once opening index02.html. Download the file and save it in html format.)
09) Once it's uploaded, click into the object and then scroll down to Server-side encryption settings. Note that we're using SSE-KMS and then it's using the key we just created. You can verify this by clicking the link of the key ARN. 
10) Now, let's see how we can change the encryption type for individual objects. Let's upload `index.html`. However, before you click upload, expand the  Properties option and scroll down to Server-side encryption. For this we'll want to specify the encryption key. Then select the override bucket settings for default encryption. Now, you will choose the Amazon S3 managed key option. Once this is done, hit upload. 
11) Now repeat step 09 and verify that SSE-S3 is the key being used. Note that this is different than the default setting of using the KMS key that we created earlier. 

## Challenge 02 Solution
01) Upload the `index.html` to the `week-06-star-wars-bucket..`. Then navigate to the CloudFront Console. Click Create distribution. For the origin domain, choose the `week-06-star-wars-bucket...` from the dropdown. The name will pre-populate. For Origin access, please choose "Origin access control settings". For the Origin access control, you'll have to create a control setting. Make sure that the signing behavior is set to "Sign requests". For the "Default root object" under Settings, make sure that you enter `index.html`.  Other selects should be left as default. Click create. Leave the other settings as default. Scroll down to the bottom and click "Create distribution". (Note: If error given due to WAF, select do not need WAF protection for lab exercise).
02) Now, we will need to add a bucket policy. This will ensure that the only ones allowed to access the bucket is CloudFront. You should see a blue banner that allows you to copy the policy. Click it and then move into the `week-06-star-wars-bucket..` bucket. Update the bucket policy and paste the code into the text field. Make sure the save the changes. 
03) Move back to the CloudFront Console. Once the CloudFront distribution is deployed, we'll test it out. It may take up to 30 minutes for it to fully deploy. Make sure that the Status = Enabled and the Last modified is filled out with a date. Once that's complete, click the ID of the distribution. You'll see a "Distribution domain name". Copy it and paste it into a browser. The website stored in S3 is now available. 
04) Let's move back to the S3 bucket hosts the index.html. In the Properties, click the Object url and paste it into a browser tab. What happens? You get an access denied. This is because the object itself is private, unless the object is accessed by the CloudFront service, and specifically, the specific distribution name that we created. This is a great method for protecting your files from malicious actors, while also serving static content to the public. 
05) Some of the features that we can enable with CloudFront is SSL certificates, geographic location restriction, and we can implement WAF ACL rules as well. One common "add-on" for this service is the ability to create a CNAME record in Route53 and redirect requests from a domain name to this content. 


## Environment Clean Up: 
***
- Disable and then destroy the CloudFront distribution. 
- Empty all of the S3 buckets that we created. 
- Schedule the KMS key for deletion. 
- Delete the stack. 
